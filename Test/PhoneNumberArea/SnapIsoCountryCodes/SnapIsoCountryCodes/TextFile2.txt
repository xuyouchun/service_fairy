 var EngagementContrastGender =                           from rows in AnalyseSourceData.AsEnumerable()                           group rows by rows.Gender into Analyse						   from c1 in AnalyseSourceData						   group c1 by c1.EngagementLevel2 into g						   select new { EngagementLevel2 = g.Key, Pre = g.Sum(p => p.Value) };						                              select new                           {                               PerName = Analyse.Key,                               s1 =                                from c1 in AnalyseSourceData                               where c1.EngagementLevel2 == "留任"                               group c1 by AnalyseSourceData into w1                               select new                                {                                   per = w1.Sum(p=>p.Value)                               },                               s2 =                                from c1 in AnalyseSourceData                               where c1.EngagementLevel2 == "赞扬"                               group c1 by AnalyseSourceData into w1                               select new                                {                                   per = w1.Sum(p=>p.Value)                               },                               s3 =                             from c1 in AnalyseSourceData                             where c1.EngagementLevel2 == "努力"                             group c1 by AnalyseSourceData into w1                             select new                             {                                 per = w1.Sum(p => p.Value)                             }                           };